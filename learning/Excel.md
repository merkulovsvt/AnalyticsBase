## Основные определения

* Любая таблица — это множество ячеек.

* Файл с таблицей — книга, а вкладки внутри книги — рабочие листы.

---

## Горячие клавиши

* `CTRL + ~` — показывает все формулы, содержащиеся в ячейках.


* `CTRL + ↓` — быстрый переход на последнюю строку в <u>столбце</u> (при повторном нажатии в <u>таблице</u>).


* `CTRL + SHIFT + ↓` — выделение всех ячеек от изначальной до последней в столбце.


* `CTRL + D` — применение формулы на весь выделенный диапазон ячеек вниз.


* `CTRL + R` — применение формулы на весь выделенный диапазон ячеек вправо.


* `CTRL + X` — скопировать + вырезать для дальнейшей вставки (`CTRL + V`).


* `CTRL + SHIFT + V` — вставить только значения.


* `F4` — закрепление координат выбранного диапазона.
    * Одно нажатие — полное закрепление.
    * Два нажатия — закреплена только строка.
    * Три нажатия — закреплён только столбец.
    * Четыре нажатия — исходное состояние.

---

## Основные функции

* `=UNIQUE(диапазон)` — выписывает в столбец все уникальные значения диапазона.


* `=COUNT(диапазон1; ...)` — считает количество чисел в наборе данных>


* `=COUNTA(диапазон1; ...)` — количество непустых ячеек в наборе данных.


* `=COUNTUNIQUE(диапазон1; ...)`  — количество уникальных ячеек в наборе данных.


* `=SUM(диапазон1; ...)` — считает сумму всех чисел в наборе данных.


* `=MAX(диапазон1; ...)` — считает максимальное число в наборе данных.


* `=MIN(диапазон1; ...)` — считает минимальное число в наборе данных.


* `=AVERAGE(диапазон1; ...)` —считает среднее число в наборе данных.


* `=COUNTIFS(диапазон критерия 1; значение критерия 1; ...)` — количество по критериям.
    * Значение критерия может быть и условием вида `"<5"`, `"<>0"`, ...


* `=SUMIFS(диапазон суммирования; диапазон критерия 1;значение критерия 1; ...)` — сумма по критериям.
    * Значение критерия может быть и условием вида `"<5"`, `"<>0"`, ...


* `=MAXIFS(диапазон вычисления максимума; диапазон_критерия1; критерий1; ...)` — максимум по критериям.
    * Значение критерия может быть и условием вида `"<5"`, `"<>0"`, ...


* `=AVERAGEIFS(диапазон вычисления среднего; диапазон_критерия1; критерий1; ...)` — среднее по критериям.
    * Значение критерия может быть и условием вида `"<5"`, `"<>0"`, ...


* `=DATE(год; месяц; день)` — собирает дату (в формате d.m.y) по компонентам.


* `=DAY(дата)` — берет номер дня из даты.


* `=MONTH(дата)` — берет номер месяца из даты.


* `=YEAR(дата)` — берет номер года из даты.


* `=VALUE(ячейка)` — преобразует текстовое значение, представляющее число, в число.


* `=LEFT(исходная строка; количество символов)` — возвращает заданное число символов слева из исходной строки.


* `=RIGHT(исходная строка; количество символов)` — возвращает заданное число символов справа из исходной строки.

---

## Константы, формулы и функции

* Внутри каждой ячейки может содержаться только две вещи — **константа** или **формула**.


* **Константа** — это любое постоянное значение, например, число 1089 или слово «Доход». Единственный способ изменить
  константу — это зайти внутрь ячейки и переписать её содержание.

* **Формула** — вычисление с константами. Тут важно, что формула, в отличие от константы, динамическая. То есть значение
  в такой ячейке автоматически поменяется, если поменять значения констант, с которыми она работает.

### Как устроены формулы

* Все формулы начинаются со знака равно. Как только вы кликаете на пустую ячейку и ставите в ней знак `=`, табличный
  редактор предчувствует, что сейчас ему придётся что-то считать.

Все формулы можно условно поделить на три больших типа: **простые формулы**, **функции** и **сложносоставные формулы**.

* **Простые формулы** созданы с помощью привычных математических символов `+` `-` `*` `/`, а также открывающих и
  закрывающих скобок.

* **Функция** — предустановленные программой формулы. У каждой функции есть своё название, которое намекает на то, что
  умеет делать эта функция.

* **Сложносоставные формулы** — это пользовательские формулы, которые состоят как и из простых формул, так и из функций.

### Как копировать формулы

* При обычном копировании формула автоматически изменяет диапазоны.

1. Копируем исходную формулу из строки формул.

2. Заходим в ячейки двойным кликом перед тем, как копировать и вставлять формулу.

---

## Типы данных

* Для таблицы существует только два типа данных: **текст** и **число**.

* Что бы вы ни написали в ячейке, таблица классифицирует это либо как **текст**, либо как **число**!

### Текст или число?

* Таблица напрямую не показывает, распознала она ваши данные как **текст** или как **число**.

* Таблица автоматически форматирует текст по левому краю, а число — по правому

Есть **обходной способ** — посмотреть, какого рода операции таблица предлагает для данных.  
Сделать это можно с помощью **панели автоподсчёта** (появляется в правом нижнем углу при выделении нескольких ячеек).

* Перед вами **текст**, если панель автоподсчёта показывает только количество заполненных ячеек.

* Перед вами **число**, если, помимо количества, она также даёт сводную информацию о сумме, среднем, ...

### Формат числовых данных

* В таблицах, кроме **типа данных**, существует ещё понятие **формат данных**.

* Типов всего два: **текст** и **число**, а форматов — <u>бесчисленное множество</u>.


* **Формат данных** — это одежда, в которую оборачиваются числа. Например, дата, валюта, ...

### Как таблица видит даты

* Таблица считает даты числами, поэтому разрешены операции `+`, `-`, ...

* Любая дата для таблиц — это число дней, прошедших с нулевого дня — условной точки отсчёта (<u>30 декабря 1899</u>).

---

## Фильтры, сортировка и режим фильтрации

### Фильтры

* С их помощью можно фильтровать данные — показывать только нужную часть и скрывать остальное.

* Применяя фильтры, вы не изменяете порядок строк, а только <u>скрываете</u> часть из них. Исходные адреса всегда можно
  увидеть слева.

* Фильтры отлично работают вместе с панелью автоподсчёта: можно считать сумму, среднее и тд не во всём наборе данных, а
  только в их части.

### Сортировка данных

* Когда вы включили фильтр на каждый столбец, у вас появилась возможность не только скрывать данные, но и сортировать
  их — задавать данным другой порядок.

* Сортировка, в отличие от фильтров, меняет порядок расположения исходных данных. При этом изменения останутся даже в
  том случае, если вы сбросите или вовсе удалите фильтры.

* Сортировку нельзя отменить: в интерфейсе программы нет кнопки для этого. Один из немногих способов — `СTRL + Z`.

### Режим фильтрации

* По сути — это **шаблон фильтров и сортировок**, который можно применять на таблицу.

* Чтобы включить режим фильтрации, можно даже не выделять все столбцы, а просто нажать
  **Данные** → **Режим фильтрации** → **Создать новый фильтр**.

* Когда вам потребуется сбросить все фильтры и сортировку, достаточно нажать на крестик в правом верхнем углу чёрной
  рамки. Вы выйдете из этого режима, и таблица снова будет в своём исходном виде.

---

## Работа с координатами

### Диапазон данных

* Диапазон данных — это набор ячеек с данными. В наборе может содержаться любое количество ячеек.
    * **Закрытые диапазоны** — `A1:C6`
    * **Открытые диапазоны** — `A:A`

### Фиксация координат

* По умолчанию все координаты **динамические**`A1`.


* Чтобы **зафиксировать** ячейку или диапазон по координате, необходимо использовать `$`.
    * `$A$1` — закреплена вся клетка.
    * `$A1` — закреплен только столбец.
    * `A$1` — закреплена только строка.

### Ссылка на другой лист

* Чтобы указать адрес ячеек из другого листа, то перед диапазоном необходимо добавить адрес листа `Sheet_name!`.
    * Если название листа состоит из нескольких слов или оно не на английском, то — `'Export Data'!` или `'Данные'!`.

---

## Выпадающие списки

* **Выпадающие списки** — это частный случай более общей функции **проверка данных**.

* **Проверка данных** позволяет установить правило для ячейки или диапазона: что там можно писать, а что нельзя.

### Создание выпадающего списка

1. Выделить необходимую ячейку или диапазон.

2. Нажать в меню **Данные** → **Настроить проверку данных** → **+ Добавить правило**. Появится меню настроек.

3. В меню можно настроить правила проверки — от них зависит, что будет делать программа, когда введённое значение не
   будет соответствовать правилу.

---

## Сводные таблицы

* **Сводные таблицы** — таблицы, которые обобщают данные по набору критериев.

### Создание сводной таблицы

* С помощью формул с условиями (своими руками).

* С помощью инструмента **сводные таблицы** (**Вставка** → **Создать сводную таблицу**).
    * Читать на [Практикуме](https://practicum.yandex.ru/profile/excel-for-work/).

### Структура сводной таблицы

* **Легенды и области значений**
    * Область значений
    * Благодаря легенде можно понять, что означают числа в области значений и "прочитать" таблицу.


* **Критерии для расчётов**
    * В легенде сводных таблиц есть ячейки со значениями критериев, по которым выполнялись расчёты.


* **Расположение**
    * В строках — если критерии располагаются в одном столбце, но в разных строках.
    * В столбцах — если критерии находятся в одной строке, но в разных столбцах.

---

## Обработка данных

### Удаление дубликатов

* **Данные** → **Очистка данных** → **Удалить повторы**.
    * Когда указываем диапазон, важно выделить все столбцы с информацией. Иначе повторы удалятся не полностью.

### Разделение текста на столбцы

* Выделить диапазон данных → **Данные** → **Разделить текст на столбцы**.

### Поиск и замена

* **Правка** → **Найти и заменить**

### Перевод результата формулы в константу

* Выделить диапазон данных → `CTRL + C` → `ПКМ` → **Специальная вставка** → **Вставить только значения**.
    * Или после копирование `CTRL + SHIFT + V`.



